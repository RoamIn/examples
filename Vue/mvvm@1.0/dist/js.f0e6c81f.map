{"version":3,"sources":["src\\js\\Dep.js","src\\js\\Observer.js","src\\js\\Watcher.js","src\\js\\Compiler.js","src\\js\\VM.js","src\\js\\index.js"],"names":["Dep","list","subs","push","forEach","update","prototype","target","Observer","data","Object","keys","_bind","key","value","dep","defineProperty","get","listen","set","newValue","notify","Watcher","node","name","vm","nodeValue","REG","Compiler","el","document","querySelector","frag","_createFragment","appendChild","createDocumentFragment","child","firstChild","_compile","nodeType","attr","attributes","hasOwnProperty","addEventListener","e","console","log","test","RegExp","$1","trim","VM","options","$options","$el","_data","addWatch","_this","message"],"mappings":"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","file":"js.f0e6c81f.map","sourceRoot":"..","sourcesContent":["class Dep {\r\n    constructor () {\r\n        this.list = []\r\n    }\r\n\r\n    listen (subs) {\r\n        this.list.push(subs)\r\n    }\r\n\r\n    notify () {\r\n        this.list.forEach(subs => {\r\n            subs.update()\r\n        })\r\n    }\r\n}\r\n\r\nDep.prototype.target = null\r\n\r\nexport default Dep","import Dep from './Dep'\r\n\r\nclass Observer {\r\n    constructor (data) {\r\n        this.data = data\r\n\r\n        Object.keys(this.data).forEach(key => {\r\n            this._bind(data, key, data[key])\r\n        })\r\n    }\r\n\r\n    _bind (data, key, value) { \r\n        const dep = new Dep()\r\n\r\n        Object.defineProperty(data, key, {\r\n            get () {\r\n                if (Dep.target) {\r\n                    dep.listen(Dep.target)\r\n                }\r\n\r\n                return value\r\n            },\r\n            set (newValue) {\r\n                if (newValue === value) {\r\n                    return\r\n                }\r\n\r\n                value = newValue\r\n\r\n                dep.notify()\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\nexport default Observer","import Dep from './Dep'\r\n\r\nclass Watcher {\r\n    constructor (node, name, vm) {\r\n        this.node = node\r\n        this.name = name\r\n        this.vm = vm\r\n\r\n        Dep.target = this\r\n        this.update()\r\n        Dep.target = null\r\n    }\r\n\r\n    update () {\r\n        this.node.nodeValue = this.vm[this.name]\r\n    }\r\n}\r\n\r\nexport default Watcher","import Watcher from './Watcher'\r\n\r\nconst REG = /\\{\\{(.*)\\}\\}/\r\n\r\nclass Compiler {\r\n    constructor (el, vm) {\r\n        this.el = document.querySelector(el)\r\n        this.vm = vm\r\n\r\n        this.frag = this._createFragment()\r\n        this.el.appendChild(this.frag)\r\n    }\r\n\r\n    _createFragment () {\r\n        const frag = document.createDocumentFragment()\r\n        let child = null\r\n\r\n        while (child = this.el.firstChild) {\r\n            this._compile(child)\r\n            frag.appendChild(child)\r\n        }\r\n\r\n        return frag\r\n    }\r\n\r\n    _compile (node) {\r\n        if (node.nodeType === 1) {\r\n            const attr = node.attributes\r\n\r\n            if (attr.hasOwnProperty('v-model')) {\r\n                const name = attr['v-model'].nodeValue\r\n\r\n                node.addEventListener('input', e => {\r\n                    this.vm[name] = e.target.value\r\n                })\r\n\r\n                node.value = this.vm[name]\r\n            }\r\n        }\r\n\r\n        console.log(node)\r\n\r\n        if (node.nodeType === 3) {\r\n            // console.log(node)\r\n            // console.log(REG.test(node.nodeValue))\r\n\r\n            if (REG.test(node.nodeValue)) {\r\n                let name = RegExp.$1\r\n\r\n                name = name.trim()\r\n                new Watcher(node, name, this.vm)\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default Compiler","import Observer from './Observer'\r\nimport Compiler from './Compiler'\r\n\r\nclass VM {\r\n    constructor (options) {\r\n        this.$options = options\r\n        this.$el = this.$options.el\r\n        this._data = this.$options.data\r\n\r\n        Object.keys(this._data).forEach(key => {\r\n            this.addWatch(key)\r\n        })\r\n\r\n        new Observer(this._data)\r\n\r\n        new Compiler(this.$el, this)\r\n    }\r\n\r\n    addWatch (key) {\r\n        const _this = this\r\n\r\n        Object.defineProperty(this, key, {\r\n            get () {\r\n                return _this._data[key]\r\n            },\r\n            set (value) {\r\n                _this._data[key] = value\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\nexport default VM","import VM from './VM'\r\n\r\nnew VM({\r\n    el: '#app',\r\n    data: {\r\n        message: 'hello vm'\r\n    }\r\n})"]}